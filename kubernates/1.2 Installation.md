# Installation

### Steps to perform on both worker and master
1. Download containerd via apt
```
apt install containerd -y
```
or

2. Installing Containerd Manually
```
wget https://github.com/containerd/containerd/releases/download/v1.6.8/containerd-1.6.8-linux-amd64.tar.gz
tar Cxzvf /usr/local containerd-1.6.8-linux-amd64.tar.gz
```
then to run containerd runc is required
```
wget https://github.com/opencontainers/runc/releases/download/v1.1.3/runc.amd64
sudo install -m 755 runc.amd64 /usr/local/sbin/runc
```
check runc is installed or not
```
which runc
```

3. then need to install cli plugin for networking
```
wget https://github.com/containernetworking/plugins/releases/download/v1.1.1/cni-plugins-linux-amd64-v1.1.1.tgz
```
```
mkdir -p /opt/cni/bin
```
```
tar Cxzvf /opt/cni/bin cni-plugins-linux-amd64-v1.1.1.tgz
```

## Installing kubeadm, kubelet and kubectl

1.Update the apt package index and install packages needed to use the Kubernetes apt repository:
```
sudo apt-get update

sudo apt-get install -y apt-transport-https ca-certificates curl gpg
```
2.Download the public signing key for the Kubernetes package repositories. The same signing key is used for all repositories so you can disregard the version in the URL
```
curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.32/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
```
3.Add the appropriate Kubernetes apt repository. Please note that this repository have packages only for Kubernetes 1.32; for other Kubernetes minor versions, you need to change the Kubernetes minor version in the URL to match your desired minor version (you should also check that you are reading the documentation for the version of Kubernetes that you plan to install).
```
echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.32/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list
```
4.Update the apt package index, install kubelet, kubeadm and kubectl, and pin their version:
```
sudo apt-get update
sudo apt-get install -y kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl
```
### Steps to perform on  master

1. allow ipv4
```
sudo modprobe br_netfilter
sudo sysctl net.ipv4.ip_forward=1
sudo sysctl -p /etc/sysctl.conf
```
2. init kubeadm master
```
sudo kubeadm init
```
3. then install kube flunnel for networking
```
kubectl apply -f https://github.com/flannel-io/flannel/releases/latest/download/kube-flannel.yml
```

### Steps to perform on  Worker
1. join worker with master
```
kubeadm join master-ip3 --token $$$$$$$$$
```

## Refrances
1. https://www.howtoforge.com/how-to-install-containerd-container-runtime-on-ubuntu-22-04
2. https://v1-32.docs.kubernetes.io/docs/setup/production-environment/container-runtimes/
